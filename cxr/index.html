<link rel="stylesheet" href="site.css" />

<!-- Load TensorFlow.js. This is required to use MobileNet. -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.1"> </script>

<!-- Load the MobileNet model. -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@1.0.0"> </script>

<!-- thirdparty -->
<script src="thirdparty/dropzone.min.js"> </script>
<link rel="stylesheet" href="thirdparty/dropzone.min.css"/>

<div id="page">

<h1>Pneumonia severity predction.</h1>

<img id="cxrImage" src="skeleton.svg" width=500 width=500></img>

<h2 id="cxrStatus">Downloading predictive model...</h2>

<form action="/file-upload"
      class="dropzone"
      id="cxrDropzone"></form>

<script>

  const mobilenetLoadPromise = mobilenet.load();

  const imageElement = document.getElementById('cxrImage');
  const dropzoneElement = document.getElementById('cxrDropzone');
  let model;

  mobilenetLoadPromise
  .then(loadedModel => {
    model = loadedModel;
    document.getElementById('cxrStatus').innerText = "Model is ready";
  });

/*
    model.classify(imageElement)
    .then(predictions => {
      const header = document.createElement("h2");
      header.innerText = 'Predictions ';
      const result = document.createElement("p");
      result.innerText = JSON.stringify(predictions);
      document.body.appendChild(header);
      document.body.appendChild(result);
    });
  });
  */

</script>

<script>
// code that needs to execute after document body is loaded
(function() {
  Dropzone.autoDiscover = false;
  dropzone = new Dropzone(dropzoneElement, {
    autoProcessQueue: true,
    accept: (file, doneFunction) => {
      console.log("in accept...");
      console.log(file);
    },
  });
  dropzone.on("addedfile", file => {
    console.log(file);
  });


})();
</script>
